---
title: "hw4"
author: "Jordan Faires"
date: "5/21/2020"
output: html_document
---

sup!

...........sup? TAKE 2 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r}

# Setting up variables and functions

# Temperature is increasing over time - temp at time t equals min of (tT / 100, T). It rises until T = 100 and flattens out after that. If we know t and T, you can plug in to the equation. t = years from now, T = BAU temperature increase at year 100.

# Save variables to make manipulation easier

# Year
t <- 200

# BAU temp increase at year 100
T <- 4.4

# Other paramaters
B <- 0.05
g <- 0.01
d <- 0.005
n <- 0.5

# Functions 

# Temperature in year T relative to temp at time 0

temp = function(t,T)
{
  out = pmin(t*T/100,T)
  return(out)
  T = 4
  t = 100
}

temp(t, T)

# Economic Activity - Activity reduces with heat over time. Fraction of economic activity retained in a year if tempt is r(t):

activity = function(B, temp)
{
  out = exp(-B*(temp^2))
  return(out)
}

activity(B, temp = temp(t, T))

# Consumption - economic activity growing over time at rate g but reduced by K. total consumption at time t is: 

consumption = function(activity, g, t)
{
  out = activity*(exp(g*t))
  return(out)
}

consumption(g, t, activity = activity(B, temp = temp(t, T))) 

# Utility - society's utility from consumption 

utility = function(consumption, n)
{
  out = ((consumption^(1-n))/(1-n))
  return(out)
}

utility(n, consumption = (consumption(g, t, activity = activity(B, temp = temp(t, T)))))

# Discount rate given by Ramsey Rule 

discount = function(d, n, g)
{
  out = d + (n*g)
  return(out)
}

r <- discount(d, n, g)


```

```{r}

# Plotting temperature 

years <- data.frame(
  year = seq(from = 0, to = 200, by = 1))
temp_time <- years %>%
  mutate(none = temp(t = year, T = 0),
         moderate = temp(t = year, T = 2),
         extreme = temp(t = year, T = 8))

colors <- c("Extreme (T = 8)" = "red3", "Moderate (T = 2)" = "seagreen", "None" = "dodgerblue")

ggplot(temp_time, aes(x = year)) +
  geom_point(aes(y = moderate, color = "Moderate (T = 2)")) + 
  geom_point(aes(y = extreme, color = "Extreme (T = 8)")) +
  geom_point(aes(y = none, color = "None")) +
  theme_minimal() + 
  labs(x = "Year",
       y = "Temperature Increase Relative to Year Zero",
       title = "Temperature Over Time Under Multiple Climate Scenarios",
       fill = "") 

# Renaming legend isn't working with a bunch of different ways to do it - can maybe just remove 

```

```{r}
# 2.a

U_disc = function(utility, r, t) {
  out = (utility/(1+r)^t)
  return(out)
}

y <- seq(0, 200, 1)

U_4.4_disc <- sum(U_disc(r, t = y, 
           utility = 
             utility(n, consumption = (consumption(g, t = y, activity = activity(B, temp = temp(t = y, T)))))))

U_4.4_indiv <- U_disc(r, t = y, 
            utility = 
              utility(n, consumption = (consumption(g, t = y, activity = activity(B, temp = temp(t = y, T))))))

U_0_disc <- sum(U_disc(r, t = y, 
           utility = 
             utility(n, consumption = (consumption(g, t = y, activity = activity(B, temp = temp(t = y, 0)))))))

U_0_indiv <- U_disc(r, t = y, 
            utility = 
              utility(n, consumption = (consumption(g, t = y, activity = activity(B, temp = temp(t = y, 0))))))

L <- (1 - (U_4.4_disc/U_0_disc))*100

# Example NPV fxn: NPV(cf0=100,cf=50,times=3,i=.05)

# 2.b
# Sensitivity to temp change (4.4 pathway only)

U_4.4_sens_T <- sum(U_disc(r, t = y, 
           utility = 
             utility(n, consumption = (consumption(g, t = y, activity = activity(B, temp = temp(t = y, T = 
                                                                                                  (T*1.1)
                                                                                                )))))))

L_sens_T <- (L - 
                        ((1 - (U_4.4_sens_T/U_0_disc))*100) # Finding new L w/ 10% change in T
                  )/L

# Sensitivity to g (economic growth rate)

U_4.4_sens_g <- sum(U_disc(r, t = y, 
           utility = 
             utility(n, consumption = (consumption(
               g = (1.1*g)
               , t = y, activity = activity(B, temp = temp(t = y, T)))))))

U_0_sens_g <- sum(U_disc(r, t = y, 
           utility = 
             utility(n, consumption = (consumption(
               g = (1.1*g)
               , t = y, activity = activity(B, temp = temp(t = y, 0)))))))

L_sens_g <- (L - 
                        ((1 - (U_4.4_sens_g/U_0_sens_g))*100)
                  )/L

# Sensitivity to n ()

L_sens_n <- abs((1 - ((utility((1.1*n), consumption = (consumption(g, t, activity = activity(B, temp = temp(t, T))))))/U_4.4)) * 100)

L_sens_B <- abs((1 - ((utility(n, consumption = (consumption(g, t, activity = activity((1.1*B), temp = temp(t, T))))))/U_4.4)) * 100)


```

